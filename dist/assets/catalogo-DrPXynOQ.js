import"./globals-CZ4RW9X3.js";const e={pdfDoc:null,currentPage:1,totalPages:0,scale:1,searchText:"",currentSearchIndex:0,searchMatches:[]},t=document.getElementById("pdf-canvas"),a=t.getContext("2d"),n=document.getElementById("page-num"),s=document.getElementById("page-count"),o=document.getElementById("prev-page"),r=document.getElementById("next-page"),c=document.getElementById("nav-prev"),i=document.getElementById("nav-next"),d=document.getElementById("zoom-in"),l=document.getElementById("zoom-out"),g=document.getElementById("zoom-level"),u=document.getElementById("search-input"),m=document.getElementById("search-btn"),p=document.getElementById("download-pdf"),b=document.getElementById("print-pdf"),h=document.getElementById("loading"),v=document.querySelector(".pdf-canvas-wrapper"),y=document.getElementById("toggle-results"),x=document.getElementById("results-panel"),E=document.getElementById("results-content");async function f(s){try{if(!e.pdfDoc)return;if(s<1||s>e.totalPages)return;e.currentPage=s,n.textContent=s;const d=await e.pdfDoc.getPage(s),l=1.5,g=d.getViewport({scale:l*e.scale});t.width=g.width,t.height=g.height;const u={canvasContext:a,viewport:g};await d.render(u).promise,o.disabled=e.currentPage<=1,r.disabled=e.currentPage>=e.totalPages,c.disabled=e.currentPage<=1,i.disabled=e.currentPage>=e.totalPages,o.classList.toggle("opacity-50",e.currentPage<=1),r.classList.toggle("opacity-50",e.currentPage>=e.totalPages),c.classList.toggle("opacity-50",e.currentPage<=1),i.classList.toggle("opacity-50",e.currentPage>=e.totalPages),v.scrollTop=0}catch(d){console.error("Erro ao renderizar página:",d)}}function L(){const t=Math.round(1.5*e.scale*100/1.5);g.textContent=`${t}%`}async function w(){const t=u.value.trim();if(!t)return e.searchText="",e.searchMatches=[],u.classList.remove("ring-2","ring-america-blue","ring-red-500"),void(E.innerHTML="");e.searchText=t.toLowerCase(),e.searchMatches=[],e.currentSearchIndex=0;try{let a=0;for(let t=1;t<=e.totalPages;t++){const n=await e.pdfDoc.getPage(t),s=await n.getTextContent();let o="";const r=[];for(const e of s.items)"str"in e&&(o+=e.str+" ",r.push(e.str));o.toLowerCase().includes(e.searchText)&&(e.searchMatches.push({pageNum:t,text:o,foundText:r.join(" ")}),a++)}if(e.searchMatches.length>0){const n=e.searchMatches[0];await f(n.pageNum),u.classList.remove("ring-red-500"),u.classList.add("ring-2","ring-america-blue"),async function(e,t){const a=t.map(e=>e.pageNum),n=[...new Set(a)],s=[];for(const i of n){const e=await P(i);s.push({pageNum:i,type:e})}const o={induzido:[],bobina:[],rotor:[],estator:[],outro:[]};s.forEach(e=>{o[e.type].push(e.pageNum)});const r={induzido:{bg:"bg-red-600",text:"text-white",label:"INDUZIDO"},bobina:{bg:"bg-amber-600",text:"text-white",label:"BOBINA"},rotor:{bg:"bg-emerald-600",text:"text-white",label:"ROTOR"},estator:{bg:"bg-blue-600",text:"text-white",label:"ESTATOR"}};let c=`\n    <div class="flex flex-col gap-4">\n      <div class="border-b border-slate-600 pb-3">\n        <p class="text-slate-300 text-sm">\n          Encontrei <span class="font-bold text-white">"${e}"</span> em <span class="font-bold text-america-blue">${n.length}</span> página${1!==n.length?"s":""}\n        </p>\n      </div>\n\n      <div class="grid gap-4">\n  `;["induzido","bobina","rotor","estator"].forEach(e=>{const t=o[e],a=r[e],n={induzido:"bobina",bobina:"induzido",rotor:"estator",estator:"rotor"}[e]||null;const s=n&&o[n].length>0;c+=`\n      <div class="border-l-4 ${a.bg} bg-slate-700/50 p-4 rounded">\n        <div class="flex items-center justify-between mb-3">\n          <span class="font-bold ${a.text} text-lg">${a.label}</span>\n          <span class="text-slate-300 text-sm">${t.length} página${1!==t.length?"s":""}</span>\n          ${s?`<span class="text-xs text-slate-400">(com ${n})</span>`:""}\n        </div>\n\n        ${t.length>0?`\n          <div class="flex items-center gap-2 flex-wrap">\n            ${t.map(e=>`\n              <button class="page-result-btn ${a.bg} hover:opacity-80 text-white font-bold py-2 px-4 rounded transition transform hover:scale-105 active:scale-95" data-page="${e}">\n                Página ${e}\n              </button>\n            `).join("")}\n          </div>\n        `:'\n          <p class="text-slate-400 text-sm italic">Nenhuma página encontrada</p>\n        '}\n      </div>\n    `}),c+="\n      </div>\n    </div>\n  ",E.innerHTML=c,document.querySelectorAll(".page-result-btn").forEach(e=>{e.addEventListener("click",async()=>{const t=parseInt(e.dataset.page);await f(t),I(`Navegado para página ${t}`,"success")})})}(t,e.searchMatches),x.classList.remove("hidden");const s=1===a?"1 resultado encontrado":`${a} resultados encontrados`;console.log(`✓ ${s} para "${t}"`),I(`${s}. Veja abaixo.`,"success")}else u.classList.remove("ring-america-blue"),u.classList.add("ring-2","ring-red-500"),console.warn(`✗ Nenhum resultado para "${t}"`),E.innerHTML=`\n        <div class="text-america-red font-semibold">\n          ❌ Nenhum resultado encontrado para "<strong>${t}</strong>"\n        </div>\n      `,x.classList.remove("hidden"),I(`Nenhum resultado para "${t}"`,"error")}catch(a){console.error("Erro ao buscar:",a),I("Erro ao realizar busca","error")}}async function P(t){try{const a=await e.pdfDoc.getPage(t),n=await a.getTextContent();let s="";for(const e of n.items)"str"in e&&(s+=e.str+" ");const o=s.toLowerCase();return o.includes("induzido")?"induzido":o.includes("bobina")?"bobina":o.includes("rotor")?"rotor":o.includes("estator")?"estator":"outro"}catch(a){return console.error("Erro ao detectar tipo:",a),"outro"}}function I(e,t="info"){const a=document.createElement("div");a.className="fixed top-4 right-4 px-4 py-3 rounded-lg text-white text-sm font-medium z-50 animate-pulse "+("success"===t?"bg-green-600":"error"===t?"bg-america-red":"bg-america-blue"),a.textContent=e,document.body.appendChild(a),setTimeout(()=>{a.remove()},3e3)}o.addEventListener("click",async()=>{e.currentPage>1&&await f(e.currentPage-1)}),r.addEventListener("click",async()=>{e.currentPage<e.totalPages&&await f(e.currentPage+1)}),c.addEventListener("click",async()=>{e.currentPage>1&&await f(e.currentPage-1)}),i.addEventListener("click",async()=>{e.currentPage<e.totalPages&&await f(e.currentPage+1)}),document.addEventListener("keydown",async t=>{"ArrowLeft"===t.key&&e.currentPage>1?await f(e.currentPage-1):"ArrowRight"===t.key&&e.currentPage<e.totalPages&&await f(e.currentPage+1)}),d.addEventListener("click",async()=>{e.scale<3&&(e.scale+=.25,L(),await f(e.currentPage))}),l.addEventListener("click",async()=>{e.scale>.5&&(e.scale-=.25,L(),await f(e.currentPage))}),y.addEventListener("click",()=>{x.classList.toggle("hidden"),y.classList.toggle("bg-blue-700")}),m.addEventListener("click",async()=>{await w()}),u.addEventListener("keydown",async e=>{"Enter"===e.key&&await w()}),p.addEventListener("click",()=>{const e=document.createElement("a");e.href="/Catálogo América 2026 COMPLETO.pdf",e.download="Catálogo América 2026 COMPLETO.pdf",document.body.appendChild(e),e.click(),document.body.removeChild(e),I("Download iniciado!","success")}),b.addEventListener("click",()=>{const e=window.open("/Catálogo América 2026 COMPLETO.pdf","_blank");e&&e.print()}),n.addEventListener("click",()=>{const t=prompt(`Digite o número da página (1-${e.totalPages}):`);if(t){const a=parseInt(t,10);!isNaN(a)&&a>=1&&a<=e.totalPages&&f(a)}});const B=document.getElementById("menuBtn"),$=document.getElementById("closeBtn"),k=document.getElementById("mobileMenu"),C=document.getElementById("overlay"),T=document.querySelectorAll("#mobileMenu a");B&&B.addEventListener("click",()=>{k.classList.add("active"),C.classList.remove("hidden")}),$&&$.addEventListener("click",()=>{k.classList.remove("active"),C.classList.add("hidden")}),C&&C.addEventListener("click",()=>{k.classList.remove("active"),C.classList.add("hidden")}),T.forEach(e=>{e.addEventListener("click",()=>{k.classList.remove("active"),C.classList.add("hidden")})}),document.addEventListener("DOMContentLoaded",()=>{!async function(){try{h.classList.remove("hidden");const t="/Catálogo América 2026 COMPLETO.pdf",a=await pdfjsLib.getDocument(t).promise;e.pdfDoc=a,e.totalPages=a.numPages,s.textContent=e.totalPages,await f(1),h.classList.add("hidden")}catch(t){console.error("Erro ao carregar PDF:",t),h.innerHTML=`\n      <div class="text-center text-america-red">\n        <p class="font-bold mb-2">Erro ao carregar o catálogo</p>\n        <p class="text-sm text-slate-400">${t.message}</p>\n        <p class="text-xs text-slate-500 mt-4">Verifique se o arquivo existe em /public</p>\n      </div>\n    `}}()});
